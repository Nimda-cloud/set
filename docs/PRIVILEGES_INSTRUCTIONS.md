# NIMDA System - Privileges and Blocking Setup Instructions

## üîê **–ü—Ä–æ–±–ª–µ–º–∞ –∑ –ø–∞—Ä–æ–ª–µ–º**

### **–ü–æ—Ç–æ—á–Ω–∞ —Å–∏—Ç—É–∞—Ü—ñ—è:**
- –°–∏—Å—Ç–µ–º–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ `dev` ‚úÖ
- Credentials —Å–∏—Å—Ç–µ–º–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∞ ‚úÖ
- –†–µ–∞–ª—å–Ω–µ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –¥–æ–¥–∞–Ω–æ ‚úÖ

### **–©–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏:**

## 1. **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è sudo –¥–æ—Å—Ç—É–ø—É**

### **–ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ sudo –ø—Ä–∞–≤–∞**
```bash
sudo whoami
```
–Ø–∫—â–æ –∑–∞–ø–∏—Ç—É—î –ø–∞—Ä–æ–ª—å - –≤–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ `dev`

### **–ö—Ä–æ–∫ 2: –ù–∞–ª–∞—à—Ç—É–π—Ç–µ sudo –±–µ–∑ –ø–∞—Ä–æ–ª—è (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)**
```bash
# –í—ñ–¥–∫—Ä–∏–π—Ç–µ sudoers —Ñ–∞–π–ª
sudo visudo

# –î–æ–¥–∞–π—Ç–µ —Ä—è–¥–æ–∫ (–∑–∞–º—ñ–Ω—ñ—Ç—å 'dev' –Ω–∞ –≤–∞—à–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞):
dev ALL=(ALL) NOPASSWD: ALL
```

### **–ö—Ä–æ–∫ 3: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è**
```bash
sudo -n whoami
```
–ü–æ–≤–∏–Ω–Ω–æ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ `root` –±–µ–∑ –∑–∞–ø–∏—Ç—É –ø–∞—Ä–æ–ª—è

## 2. **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è firewall (pfctl)**

### **–ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–∞—Ç—É—Å firewall**
```bash
sudo pfctl -s info
```

### **–ö—Ä–æ–∫ 2: –°—Ç–≤–æ—Ä—ñ—Ç—å –±–∞–∑–æ–≤—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é**
```bash
# –°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
sudo nano /etc/pf.conf

# –î–æ–¥–∞–π—Ç–µ –±–∞–∑–æ–≤—ñ –ø—Ä–∞–≤–∏–ª–∞:
set skip on lo
block drop in proto tcp from any to any port 22
block drop in proto tcp from any to any port 23
```

### **–ö—Ä–æ–∫ 3: –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –ø—Ä–∞–≤–∏–ª–∞**
```bash
sudo pfctl -ef /etc/pf.conf
```

## 3. **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∏**

### **–ó–∞–ø—É—Å—Ç—ñ—Ç—å —Ç–µ—Å—Ç:**
```bash
python3 test_privileges_fix.py
```

### **–û—á—ñ–∫—É–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏:**
```
üîê Sudo Access: ‚úÖ PASS
üîë Credentials Verification: ‚úÖ PASS  
üõ°Ô∏è Firewall Commands: ‚úÖ PASS
üë§ PrivilegeManager: ‚úÖ PASS
```

## 4. **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ —Å–∏—Å—Ç–µ–º—ñ**

### **–ü—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:**
1. **–ü–∞—Ä–æ–ª—å –±—É–¥–µ –ø—Ä–∏–π–º–∞—Ç–∏—Å—è** - —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∞–ª—å–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î sudo –¥–æ—Å—Ç—É–ø
2. **–ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ** - IP –∞–¥—Ä–µ—Å–∏ —Ç–∞ –ø–æ—Ä—Ç–∏ –±—É–¥—É—Ç—å –±–ª–æ–∫—É–≤–∞—Ç–∏—Å—è —á–µ—Ä–µ–∑ pfctl
3. **Security policy –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏–º–µ—Ç—å—Å—è** - –≤—Å—ñ –¥—ñ—ó –±—É–¥—É—Ç—å —Ä–µ–∞–ª—å–Ω–∏–º–∏

### **–ü—Ä–∏–∫–ª–∞–¥–∏ –¥—ñ–π:**
- `üö´ Blocking: 104.18.19.125.443` ‚Üí IP `104.18.19.125` –±—É–¥–µ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏–π
- `üö´ Blocking: Port 7000` ‚Üí –ü–æ—Ä—Ç `7000` –±—É–¥–µ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏–π
- `üîí Isolating: suspicious_process` ‚Üí –ü—Ä–æ—Ü–µ—Å –±—É–¥–µ —ñ–∑–æ–ª—å–æ–≤–∞–Ω–∏–π

## 5. **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–±–æ—Ç–∏**

### **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω—ñ IP:**
```bash
sudo pfctl -s rules
```

### **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω—ñ –ø–æ—Ä—Ç–∏:**
```bash
sudo pfctl -s rules | grep port
```

### **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏:**
```bash
sudo pfctl -s info
```

## 6. **–£—Å—É–Ω–µ–Ω–Ω—è –Ω–µ–ø–æ–ª–∞–¥–æ–∫**

### **–ü—Ä–æ–±–ª–µ–º–∞: "Failed to verify privileges"**
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ sudo –ø—Ä–∞–≤–∞ —Ç–∞ –ø–∞—Ä–æ–ª—å

### **–ü—Ä–æ–±–ª–µ–º–∞: "Firewall commands require privileges"**
**–†—ñ—à–µ–Ω–Ω—è:** –ù–∞–ª–∞—à—Ç—É–π—Ç–µ pfctl —Ç–∞ sudo –ø—Ä–∞–≤–∞

### **–ü—Ä–æ–±–ª–µ–º–∞: "Block action failed"**
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é pfctl

## 7. **–ë–µ–∑–ø–µ–∫–∞**

### **–í–∞–∂–ª–∏–≤–æ:**
- –ù–µ –Ω–∞–¥–∞–≤–∞–π—Ç–µ NOPASSWD sudo –ø—Ä–∞–≤–∞ –±–µ–∑ –ø–æ—Ç—Ä–µ–±–∏
- –†–µ–≥—É–ª—è—Ä–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ firewall
- –ú–æ–Ω—ñ—Ç–æ—Ä—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø—ñ–¥–æ–∑—Ä—ñ–ª–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

### **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:**
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —á–∞—Å–æ–≤—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è –¥–ª—è sudo
- –ù–∞–ª–∞—à—Ç—É–π—Ç–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö –¥—ñ–π
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–Ω–æ–≤–ª—é–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–ø–µ–∫–∏

## üéØ **–†–µ–∑—É–ª—å—Ç–∞—Ç**

–ü—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–∏—Å—Ç–µ–º–∞ NIMDA –±—É–¥–µ:
- ‚úÖ –ü—Ä–∏–π–º–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø–∞—Ä–æ–ª—å
- ‚úÖ –†–µ–∞–ª—å–Ω–æ –±–ª–æ–∫—É–≤–∞—Ç–∏ –∑–∞–≥—Ä–æ–∑–∏
- ‚úÖ –í–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –≤—Å—ñ security policy –¥—ñ—ó
- ‚úÖ –ü—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –ø–æ–≤–Ω–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è!** üöÄ 