# NIMDA-Mac Security Rules Configuration

## Overview
–¶–µ–π —Ñ–∞–π–ª –ø–æ—è—Å–Ω—é—î, —è–∫ —Å–∏—Å—Ç–µ–º–∞ NIMDA-Mac –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–ø–µ–∫–∏.

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–∞–≤–∏–ª

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–ø–µ–∫–∏ –∑ –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –¥–∂–µ—Ä–µ–ª:

### Emerging Threats Rules
- **–î–∂–µ—Ä–µ–ª–æ**: https://rules.emergingthreats.net/open/suricata-6.0/emerging-all.rules
- **–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –í–∏—è–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–æ–º–∏—Ö –∑–∞–≥—Ä–æ–∑ —Ç–∞ –∞—Ç–∞–∫
- **–§–æ—Ä–º–∞—Ç**: Suricata/Snort –ø—Ä–∞–≤–∏–ª–∞
- **–ß–∞—Å—Ç–æ—Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è**: –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è —â–æ–¥–µ–Ω–Ω–æ

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–∫–∏ rules/

–ü—ñ—Å–ª—è –ø–µ—Ä—à–æ–≥–æ –∑–∞–ø—É—Å–∫—É —Å–∏—Å—Ç–µ–º–∞ —Å—Ç–≤–æ—Ä–∏—Ç—å:
```
rules/
‚îú‚îÄ‚îÄ emerging-all.rules          # –ü—Ä–∞–≤–∏–ª–∞ Emerging Threats
‚îî‚îÄ‚îÄ custom-rules.rules          # –ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –ø—Ä–∞–≤–∏–ª–∞ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
```

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
```python
from core.rule_manager import RuleManager

manager = RuleManager()
manager.update_all_rules()  # –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –≤—Å—ñ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞
rules = manager.get_parsed_rules()  # –ü–∞—Ä—Å–∏—Ç—å –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
```

### –†—É—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ GUI
1. –ó–∞–ø—É—Å—Ç—ñ—Ç—å GUI: `python gui/nimda_gui.py`
2. –ú–µ–Ω—é Security ‚Üí Update Rules
3. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç—å –æ—Å—Ç–∞–Ω–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞

### –†—É—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —á–µ—Ä–µ–∑ CLI
```bash
python core/rule_manager.py
```

## –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏—Ö –ø—Ä–∞–≤–∏–ª

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `rules/custom-rules.rules` –¥–ª—è –≤–ª–∞—Å–Ω–∏—Ö –ø—Ä–∞–≤–∏–ª:

```
# –ü—Ä–∏–∫–ª–∞–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞
alert tcp any any -> any 22 (msg:"SSH –±—Ä—É—Ç-—Ñ–æ—Ä—Å —Å–ø—Ä–æ–±–∞"; content:"Failed password"; threshold: type both, track by_src, count 5, seconds 60; sid:1000001;)

# –ü—Ä–∞–≤–∏–ª–æ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø—ñ–¥–æ–∑—Ä—ñ–ª–∏—Ö –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å
alert http any any -> any any (msg:"–ü—ñ–¥–æ–∑—Ä—ñ–ª–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è script"; content:"GET"; content:".sh"; content:".py"; sid:1000002;)
```

## –ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –¥–∂–µ—Ä–µ–ª–∞ –ø—Ä–∞–≤–∏–ª

1. **Emerging Threats** (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)
   - –ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞
   - –†–µ–≥—É–ª—è—Ä–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
   - –®–∏—Ä–æ–∫–µ –ø–æ–∫—Ä–∏—Ç—Ç—è –∑–∞–≥—Ä–æ–∑

2. **–ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –ø—Ä–∞–≤–∏–ª–∞**
   - –ü—Ä–∞–≤–∏–ª–∞ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –¥–ª—è –≤–∞—à–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
   - –õ–æ–∫–∞–ª—å–Ω—ñ –∑–∞–≥—Ä–æ–∑–∏
   - –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ñ –ø–æ–ª—ñ—Ç–∏–∫–∏

## –ü—Ä–∏–º—ñ—Ç–∫–∏ –∑ –±–µ–∑–ø–µ–∫–∏

‚ö†Ô∏è **–í–∞–∂–ª–∏–≤–æ**: –§–∞–π–ª–∏ –ø—Ä–∞–≤–∏–ª –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ —Ä—è–¥–∫–∏, —è–∫—ñ GitHub –º–æ–∂–µ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É–≤–∞—Ç–∏ —è–∫ —Å–µ–∫—Ä–µ—Ç–∏ (OAuth —Ç–æ–∫–µ–Ω–∏, API –∫–ª—é—á—ñ —Ç–æ—â–æ). –¶–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –ø—Ä–∞–≤–∏–ª –±–µ–∑–ø–µ–∫–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ –º—ñ—Å—Ç—è—Ç—å –ø—Ä–∏–∫–ª–∞–¥–∏ –∞—Ç–∞–∫.

üìÅ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –ü–∞–ø–∫–∞ `rules/` –¥–æ–¥–∞–Ω–∞ –¥–æ `.gitignore` –¥–ª—è —É–Ω–∏–∫–Ω–µ–Ω–Ω—è false positive —Å–ø—Ä–∞—Ü—å–æ–≤—É–≤–∞–Ω—å GitHub Secret Scanning.

## –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –ø—Ä–∞–≤–∏–ª

–°–∏—Å—Ç–µ–º–∞ –Ω–∞–¥–∞—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Å–ø—Ä–∞—Ü—å–æ–≤—É–≤–∞–Ω–Ω—é –ø—Ä–∞–≤–∏–ª:
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø—Ä–∞—Ü—å–æ–≤—É–≤–∞–Ω—å –ø–æ SID
- –¢–∏–ø–∏ –≤–∏—è–≤–ª–µ–Ω–∏—Ö –∑–∞–≥—Ä–æ–∑
- –ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –ø—Ä–∞–≤–∏–ª

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–∞–≤–∏–ª–∞ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è
**–†—ñ—à–µ–Ω–Ω—è**: –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç-–∑'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞ –¥–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å –¥–∂–µ—Ä–µ–ª

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–∞–≥–∞—Ç–æ false positive
**–†—ñ—à–µ–Ω–Ω—è**: –ù–∞–ª–∞—à—Ç—É–π—Ç–µ –±—ñ–ª—ñ —Å–ø–∏—Å–∫–∏ —É `configs/security_policy.json`

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–∏–∑—å–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
**–†—ñ—à–µ–Ω–Ω—è**: –û–ø—Ç–∏–º—ñ–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞, –≤–∏–¥–∞–ª—ñ—Ç—å –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ñ
